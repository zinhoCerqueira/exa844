<html>

<head>
  <title>My Blog</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <script type="application/javascript">
    function send(event) {
      data = {
        "message": document.getElementById("msg").value,
        "author": document.getElementById("autor").value
      };
      var json_data = JSON.stringify(data);

      var header = {
        "Cotent-Type": "application/json"
      };

      var url = "https://script.google.com/macros/s/AKfycbzBn3sALe1rYjz7Ze-Ik7q9TEVP0I2V3XX7GNcecWP8NvCzGt4yO_RT1OlQp09TE9cU/exec";

      fetch(url, {
        method: "POST",
        body: json_data,
        headers: header,
        mode: "no-cors"
      });
    }
  </script>
</head>

<body>
  <H1 align="center">Mensagem:</H1>
  <HR><br>
  <form align="center">
    <label>Mensagem:</label>
    <input type="text" size=64 name="msg" id="msg"><br><br>
    <label>Autor:</label>
    <input type="text" size=64 name="autor" id="autor">
    <br><br>
    <button type="button" onclick="send()">Enviar</button>

    <button type="button" onclick="get()">RELOAD</button>


  </form>
  <HR><br>

  <table border=1 id="tabela">
    <tr>

      <td>Mensagem</td>
      <td>Autor</td>
      <td>Time</td>

    </tr>
    <tr>
      <td><span id="autor"></span></td>
      <td><span id="msg"></span></td>
      <td><span id="time"></span></td>
    </tr>

  </table>

  <style>
    #tabela {
      width: 100%;
      /* height: 100%; */
    }
  </style>


  <script>

    function get(event) {

      var url = "https://script.google.com/macros/s/AKfycbzBn3sALe1rYjz7Ze-Ik7q9TEVP0I2V3XX7GNcecWP8NvCzGt4yO_RT1OlQp09TE9cU/exec";
      const tabela = document.getElementById("tabela");
      while (tabela.rows.length > 0) {
        tabela.deleteRow(0);
      }

      

      // url = url + "/tenho=" + (numRows-2);

      var ajax = new XMLHttpRequest()
      ajax.open("GET", url, true);
      ajax.onload = function () {
        if (ajax.status === 200) {
          var jsonObj = JSON.parse(ajax.responseText); //JSON.parse()

          for (let i = 0; i < jsonObj.length; i++) {
            var linha = tabela.insertRow(-1);

            // definir o valor de cada cÃ©lula com o valor correspondente do array
            var autorCell = linha.insertCell(0);
            autorCell.innerHTML = (jsonObj[i])[0];

            var msgCell = linha.insertCell(1);
            msgCell.innerHTML = (jsonObj[i])[1];

            var timeCell = linha.insertCell(2);
            timeCell.innerHTML = (jsonObj[i])[2];
          }

        }

      }

      ajax.send();

    }


  </script>
</body>

</html>